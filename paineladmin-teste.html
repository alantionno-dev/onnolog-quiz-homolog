<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <title>ADM OnnoLog - Restaurado</title>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <style>
        :root { --primary: #018578; --bg: #0f172a; --text: #ffffff; }
        body { font-family: sans-serif; background: var(--bg); color: var(--text); padding: 20px; }
        .card { background: var(--primary); padding: 30px; border-radius: 20px; max-width: 500px; margin: 0 auto; }
        input { width: 100%; padding: 10px; margin: 10px 0; border-radius: 8px; border: none; box-sizing: border-box; }
        button { width: 100%; padding: 12px; background: white; color: var(--primary); border: none; border-radius: 8px; font-weight: bold; cursor: pointer; }
        .hidden { display: none; }
    </style>
</head>
<body>
    <div id="login-screen" class="card">
        <h2>üîê Login ADM</h2>
        <input type="text" id="setor" placeholder="Setor (TI)">
        <input type="password" id="pass" placeholder="Senha">
        <button onclick="logar()">ENTRAR</button>
    </div>

    <div id="dash-screen" class="card hidden">
        <h2>‚ûï Nova Pergunta</h2>
        <input type="text" id="q" placeholder="Pergunta">
        <input type="text" id="c" placeholder="Correta">
        <input type="text" id="e1" placeholder="Errada 1">
        <input type="text" id="e2" placeholder="Errada 2">
        <button onclick="salvar()">SALVAR PERGUNTA</button>
    </div>

    <script>
        const _supabase = supabase.createClient('https://vkhhxafaallprvqoxmkm.supabase.co', 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InZraGh4YWZhYWxscHJ2cW94mkmIiwicm9sZSI6ImFub24iLCJpYXQiOjE3Njk2MDMxMDksImV4cCI6MjA4NTE3OTEwOX0.VDk20bjL9AxV4aHrZX-fH7xBrhndqxwrjFdFlxJrbBk');

        async function logar() {
            const s = document.getElementById('setor').value;
            const p = document.getElementById('pass').value;
            const { data } = await _supabase.from('gestores').select('*').eq('setor', s).eq('senha', p).single();
            if(data) {
                document.getElementById('login-screen').classList.add('hidden');
                document.getElementById('dash-screen').classList.remove('hidden');
            } else { alert("Acesso negado!"); }
        }

        async function salvar() {
            const payload = {
                pergunta: document.getElementById('q').value,
                opcoes: [document.getElementById('c').value, document.getElementById('e1').value, document.getElementById('e2').value],
                correta: 0 // A primeira op√ß√£o (c) √© sempre a correta
            };
            const { error } = await _supabase.from('perguntas').insert([payload]);
            if(!error) { alert("Pergunta salva!"); location.reload(); }
            else { alert("Erro: " + error.message); }
        }
    </script>
</body>
</html>
